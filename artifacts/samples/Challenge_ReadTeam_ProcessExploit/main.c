// gcc -m32 -w -fno-stack-protector -no-pie main.c -o challenge
#include <stdio.h>

int main()
{
    char buf[1024];
    char secret1[64];
    char flag[64];
    char secret2[64];

    FILE *fp;

    fp = fopen("secret1", "r");
    if (fp)
    {
        fgets(secret1, sizeof(secret1), fp);
        fclose(fp);
    }

    fp = fopen("flag", "r");
    if (fp)
    {
        fgets(flag, sizeof(flag), fp);
        fclose(fp);
    }

    fp = fopen("secret2", "r");
    if (fp)
    {
        fgets(secret2, sizeof(secret2), fp);
        fclose(fp);
    }

    printf("Password:");
    fflush(stdout);
    scanf("%1024s", buf);
    if (strcmp(buf, flag) != 0)
    {
        printf(buf);
        printf("is incorrect!\n", buf);
        fflush(stdout);
        return 1;
    }
    else
    {
        execvp("/bin/sh", NULL);
    }
    fflush(stdout);

    return 0;
}